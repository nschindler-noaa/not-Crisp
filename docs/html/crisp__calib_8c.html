<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>COMPASS Source Code: crisp_calib.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul>
</div>
<h1>crisp_calib.c File Reference</h1>crisp_calib tool (see <a class="el" href="crisp__calib_8c.html#crisp_calib">CRiSP1 Calibration Tool</a>). <a href="#_details">More...</a>
<p>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;malloc.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;dirent.h&gt;</code><br>
<code>#include &lt;pwd.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;sys/stat.h&gt;</code><br>
<code>#include &lt;sys/param.h&gt;</code><br>
<code>#include &lt;netdb.h&gt;</code><br>
<code>#include &lt;time.h&gt;</code><br>
<code>#include &quot;<a class="el" href="crisp__calib_8h.html">crisp_calib.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="version_8h.html">version.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4f50776d2b07d79d4ce0ef00615d3585"></a><!-- doxytag: member="crisp_calib.c::AnnounceFatalError" ref="4f50776d2b07d79d4ce0ef00615d3585" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="crisp__calib_8c.html#4f50776d2b07d79d4ce0ef00615d3585">AnnounceFatalError</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Announce a fatal error and terminate. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
crisp_calib tool (see <a class="el" href="crisp__calib_8c.html#crisp_calib">CRiSP1 Calibration Tool</a>). 
<p>
Not part of COMPASS GUI or batch mode! (see <a class="el" href="crisp__calib_8c.html#crisp_calib">CRiSP1 Calibration Tool</a>)<h2><a class="anchor" name="crisp_calib">
CRiSP1 Calibration Tool</a></h2>
This is a stand-alone program used to invoke crisp1 with a specific set of calibration parameters. In a typical use, it is called repeatedly from a top-level calibration program, which specifies a different set of parameters for each invocation, and analyzes the resulting crisp output datafile at each step. The calling program is responsible for performing the data extraction from the crisp output file. The file "crisp_extract.c" contains a routine suitable for this purpose.<p>
The basic working of the program is as follows:<p>
1) Using the information in the crisp_calib input data file, a crisp1 <a class="el" href="structrelease.html" title="Release parameters.">release</a> data file is generated. The <a class="el" href="structrelease.html" title="Release parameters.">release</a> data file will contain an independent <a class="el" href="structrelease.html" title="Release parameters.">release</a> for each "release date" specified in the input data file (see below). Each <a class="el" href="structrelease.html" title="Release parameters.">release</a> will be tagged using the crisp1 "rt_stock" token, which will be generated as the <a class="el" href="structstock.html" title="The general design is that there are a number of custom stocks, designated int the...">stock</a> name followed by an underscore followed by the date of the <a class="el" href="structrelease.html" title="Release parameters.">release</a> (e.g. "Snaketrap_Ch1_107"). It is necessary to use this as an indentifier when performing an extraction. The "crisp_extract" routine mentioned above is configured to generate this type of <a class="el" href="structrelease.html" title="Release parameters.">release</a> identifier from a <a class="el" href="structstock.html" title="The general design is that there are a number of custom stocks, designated int the...">stock</a> name and original <a class="el" href="structrelease.html" title="Release parameters.">release</a> date.<p>
2) The user also specifies a crisp input data file to use, and an awk script to be <a class="el" href="structrun.html" title="Entire run parameters.">run</a> on the specified datafile. The user may optionally specify a sed command to first <a class="el" href="structrun.html" title="Entire run parameters.">run</a> on the awk script itself, and a string constituting the command line parameters for the awk invocation. A final awk script is generated, which is then used with the crisp input file to create a new crisp input file with the parameters appropriate to the current <a class="el" href="structrun.html" title="Entire run parameters.">run</a>. Finally, the <a class="el" href="structrelease.html" title="Release parameters.">release</a> file generated in step 1 is "included" in the new crisp data file.<p>
3) The crisp1 executable is invoked, specifying the new input data file created by the awk script in step 2.<p>
Extraction of result data is not performed. crisp1 is invoked in "realtime" mode, and the resulting realtime raw output data file is left in its default location for examination by the user or calling program.<p>
The user may specify the name of the crisp_calib input data file on the command line. If not specified, the default input file (see "crisp_calib.h" for name) is used. The crisp_calib input data file consists of a series of token/value pairs. The tokens are specified in the "crisp_calib.h" header file.<p>
Crisp_calib input data tokens: A new <a class="el" href="structrelease.html" title="Release parameters.">release</a> record is specified with the "release_site" token. This must appear prior to other <a class="el" href="structrelease.html" title="Release parameters.">release</a> information. The "stock" and "species" tokens specify actual <a class="el" href="structstock.html" title="The general design is that there are a number of custom stocks, designated int the...">stock</a> and <a class="el" href="structspecies.html" title="Species parameters.">species</a> names found in the crisp1 data file corresponding to the <a class="el" href="structrelease.html" title="Release parameters.">release</a> currently being specified. The "release_site" must also specify a <a class="el" href="structrelease.html" title="Release parameters.">release</a> named in the crisp1 river description file ("columbia.desc" by default). "smolt_onset" and "smolt_finish" specify the values of those crisp variables. The "rls_date:length:number" specifies the dates on which to <a class="el" href="structrelease.html" title="Release parameters.">release</a> a generic number of fish, an average length for each, and the number to <a class="el" href="structrelease.html" title="Release parameters.">release</a>. If the length given is 0, then no length-dependent calculations occur in crisp. The number of dates is given as part of the value of this token. Note that these will be created as fully independent <a class="el" href="structpoint.html" title="Point structure that represents a geographic point using latitude and longitude.">point</a> releases, and will not be merged on output.<p>
Here are the contents of a sample "crisp_calib.input" file:<p>
crisp_datafile 97.dat awk_script calibration.awk awk_sed_cmd '/stockname/s//Snaketrap_Ch1/' awk_parameters Bmin=3.5 Bmax=2.0 <a class="el" href="structrelease__site.html" title="Release site structure.">release_site</a> Wild_Snake_R_Stocks <a class="el" href="structstock.html" title="The general design is that there are a number of custom stocks, designated int the...">stock</a> Snaketrap_Ch1 <a class="el" href="structspecies.html" title="Species parameters.">species</a> Steelhead smolt_onset 80 smolt_finish 80 rls_date:length:number (3) 107:150.0:10000 136:99.0:10000 137:145.2:10000 <hr size="1"><address style="text-align: right;"><small>Generated on Mon Feb 4 10:53:43 2008 for COMPASS Source Code by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
