<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>COMPASS Source Code: Monte Carlo mode</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul>
</div>
<h1><a class="anchor" name="monte">Monte Carlo mode</a></h1>At a high level, Monte Carlo mode runs the model multiple times to see how variance in parameters affects the output.<p>
Monte Carlo mode starts by reading in the list of alternatives (which is in a file called ".compass-alts"). A Monte Carlo alternative is just the word for a specific configuration of how to <a class="el" href="structrun.html" title="Entire run parameters.">run</a> Monte Carlo mode and can be thought of as analogous to an input file in scenario mode (although part of a Monte Carlo alternative is an input file). For each alternative it expects a directory to exist (e.g. altern1, altern2). In the alternative directory it reads in a .alt file which contains a few parameters (these are read in from the parse_alt.c file).<p>
The alternative description file can have some interesting settings that aren't possible in a scenario file. An example of this is the ability to read from a flow archive file instead of from the flow data in a scenario file (see <a class="el" href="monte.html#flow_archive">Flow archive files</a>).<p>
Monte Carlo runs can also be <a class="el" href="structrun.html" title="Entire run parameters.">run</a> with different river environments inputs ("yearly input files") which are based on specific years. Then for each year, it can <a class="el" href="structrun.html" title="Entire run parameters.">run</a> a specific number of "games" which is just another term for complete model executions/simulations. These options allow the user to see how the changes affect a <a class="el" href="structrelease.html" title="Release parameters.">release</a> across different years (since river conditions vary from year to year).<p>
Monte Carlo mode also makes use of the ability to lock output settings. What this means is that output settings (see <a class="el" href="output__flags_8h.html#output_settings">Output Settings in COMPASS</a>) are read in and then not allowed to be changed by the input files so that each input file produces the same selection of outputs regardless of the output settings contained in the input file.<p>
Finally, Monte Carlo mode has an option for disabling variance suppression. Variance suppression makes it so that each <a class="el" href="structrun.html" title="Entire run parameters.">run</a> of the model on an input file should produce exactly the same output. In Monte Carlo mode, obviously, one usually does not want variance to be suppressed so disabling variance suppression essentially ignores the variance suppression specified in the input file (in a similar manner to the lock output settings described above).<h2><a class="anchor" name="monte_spill">
Monte Carlo flow and spill</a></h2>
Flows may be allocated differently in Monte Carlo mode than in scenario mode. For one, flows may come from a flow archive file (which may contain spill information as well).<p>
Flows are calculated using a backward propagation algorithm up to the headwaters. It is important to be aware that flow may be handled in more than one way (i.e. more than just the scenario mode way).<p>
Spills may also be read in differently for Monte Carlo mode and this can be observed in the fact that for Monte Carlo mode monte_spill.c is used as opposed to the regular <a class="el" href="spill_8c.html" title="support routines for spill calculations">spill.c</a> for scenario mode.<h2><a class="anchor" name="flow_archive">
Flow archive files</a></h2>
Flow archive files are specially formatted files that contain flow information as well as spill data at dams. It is my understanding that these files are generated by other groups so the normal COMPASS input formatting is not used. Most of this code is in parse_archive.c and monte_spill.c for reference.<p>
Note that it is now possible to read in spill information from a flow archive file and then using the -o option write out a normal input file that contains the spill schedules from the flow archive file in normal COMPASS format. This hasn't been used much but I have found it to be very helpful since flow archive files can only be used in Monte Carlo mode whereas other input files can be used universally. <hr size="1"><address style="text-align: right;"><small>Generated on Mon Feb 4 10:53:44 2008 for COMPASS Source Code by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
